<?xml version="1.0"?><CLASS_ROOT><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Cruscotto magazzino</DESCRIPT><UUID>AFBWoCPaHuadhc8bGzmSBA==</UUID><CATEGORY>00</CATEGORY><EXPOSURE>2</EXPOSURE><STATE>1</STATE><RELEASE>0</RELEASE><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON><CHGDANYON>0000-00-00</CHGDANYON><CLSFINAL>X</CLSFINAL><CLSCCINCL>X</CLSCCINCL><FIXPT>X</FIXPT><UNICODE>X</UNICODE><R3RELEASE>750</R3RELEASE><CLSBCCAT>00</CLSBCCAT><DURATION_TYPE>0</DURATION_TYPE><RISK_LEVEL>0</RISK_LEVEL><ATTRIBUTES><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GS_SEL</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Parametri di selezione</DESCRIPT><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>1</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON><ATTDECLTYP>0</ATTDECLTYP><ATTEXPVIRT>0</ATTEXPVIRT><TYPTYPE>1</TYPTYPE><TYPE>TY_S_SEL</TYPE><SRCROW1>0</SRCROW1><SRCCOLUMN1>0</SRCCOLUMN1><SRCROW2>0</SRCROW2><SRCCOLUMN2>0</SRCCOLUMN2><R3RELEASE>750</R3RELEASE><TYPESRC_LENG>0</TYPESRC_LENG></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GO_SALV</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Classe gestione alv grid</DESCRIPT><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>2</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON><ATTDECLTYP>0</ATTDECLTYP><ATTEXPVIRT>0</ATTEXPVIRT><TYPTYPE>3</TYPTYPE><TYPE>ZCL_BC_ALV_BASE</TYPE><SRCROW1>0</SRCROW1><SRCCOLUMN1>0</SRCCOLUMN1><SRCROW2>0</SRCROW2><SRCCOLUMN2>0</SRCCOLUMN2><R3RELEASE>750</R3RELEASE><TYPESRC_LENG>0</TYPESRC_LENG></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GT_DATA_SEL1</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>3</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON><ATTDECLTYP>0</ATTDECLTYP><ATTEXPVIRT>0</ATTEXPVIRT><TYPTYPE>1</TYPTYPE><TYPE>TY_T_DATA_SEL1</TYPE><SRCROW1>0</SRCROW1><SRCCOLUMN1>0</SRCCOLUMN1><SRCROW2>0</SRCROW2><SRCCOLUMN2>0</SRCCOLUMN2><R3RELEASE>750</R3RELEASE><TYPESRC_LENG>0</TYPESRC_LENG></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GT_ALV_SEL1</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>4</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON><ATTDECLTYP>0</ATTDECLTYP><ATTEXPVIRT>0</ATTEXPVIRT><TYPTYPE>1</TYPTYPE><TYPE>TY_T_ALV_SEL1</TYPE><SRCROW1>0</SRCROW1><SRCCOLUMN1>0</SRCCOLUMN1><SRCROW2>0</SRCROW2><SRCCOLUMN2>0</SRCCOLUMN2><R3RELEASE>750</R3RELEASE><TYPESRC_LENG>0</TYPESRC_LENG></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GT_DATA_SEL2</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>5</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><ATTDECLTYP>0</ATTDECLTYP><ATTEXPVIRT>0</ATTEXPVIRT><TYPTYPE>1</TYPTYPE><TYPE>TY_T_DATA_SEL2</TYPE><SRCROW1>0</SRCROW1><SRCCOLUMN1>0</SRCCOLUMN1><SRCROW2>0</SRCROW2><SRCCOLUMN2>0</SRCCOLUMN2><R3RELEASE>750</R3RELEASE><TYPESRC_LENG>0</TYPESRC_LENG></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GT_ALV_SEL2</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>6</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><ATTDECLTYP>0</ATTDECLTYP><ATTEXPVIRT>0</ATTEXPVIRT><TYPTYPE>1</TYPTYPE><TYPE>TY_T_ALV_SEL2</TYPE><SRCROW1>0</SRCROW1><SRCCOLUMN1>0</SRCCOLUMN1><SRCROW2>0</SRCROW2><SRCCOLUMN2>0</SRCCOLUMN2><R3RELEASE>750</R3RELEASE><TYPESRC_LENG>0</TYPESRC_LENG></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GV_PFSTATUS2</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Stato GUI</DESCRIPT><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>7</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><ATTDECLTYP>0</ATTDECLTYP><ATTEXPVIRT>0</ATTEXPVIRT><TYPTYPE>1</TYPTYPE><TYPE>SYPFKEY</TYPE><SRCROW1>0</SRCROW1><SRCCOLUMN1>0</SRCCOLUMN1><SRCROW2>0</SRCROW2><SRCCOLUMN2>0</SRCCOLUMN2><R3RELEASE>750</R3RELEASE><TYPESRC_LENG>0</TYPESRC_LENG></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GV_REFRESH_DATA</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>8</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-13</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON><ATTDECLTYP>0</ATTDECLTYP><ATTEXPVIRT>0</ATTEXPVIRT><TYPTYPE>1</TYPTYPE><TYPE>ABAP_BOOL</TYPE><SRCROW1>0</SRCROW1><SRCCOLUMN1>0</SRCCOLUMN1><SRCROW2>0</SRCROW2><SRCCOLUMN2>0</SRCCOLUMN2><R3RELEASE>750</R3RELEASE><TYPESRC_LENG>0</TYPESRC_LENG></item></ATTRIBUTES><METHODS><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CONSTRUCTOR</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Costruttore</DESCRIPT><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>2</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CREATE_SELECTIONS</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Crea parametri di selezione</DESCRIPT><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>2</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><R3RELEASE>750</R3RELEASE><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>EXECUTE</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Esegue programma</DESCRIPT><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>3</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Estrazione dati</DESCRIPT><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>4</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA_SEL1</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Estrazione dati per parametro P_SEL1</DESCRIPT><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>5</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA_SEL2</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Estrazione dati per parametro P_SEL2</DESCRIPT><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>6</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>SET_SALV</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>7</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_SALV</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>8</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>ALV_SHOW</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Mostra alv</DESCRIPT><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>9</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>10</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CLOSE_REQ</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>11</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>PREL_COMP</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>12</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>LOAD_GIAC</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>13</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>SCARICA_GIAC</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>14</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TRASF_GIAC</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>15</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CONS_GIAC</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>16</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>REFRESH_DATA</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>17</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-13</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CHECK_REQ_FIELDS</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>18</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><R3RELEASE>750</R3RELEASE><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>MOVE_BAPI_TO_LOCAL</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>19</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><R3RELEASE>750</R3RELEASE><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>REGISTRA_MOV</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>20</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><R3RELEASE>750</R3RELEASE><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>EXECUTE_SEL3</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>0</EXPOSURE><STATE>1</STATE><EDITORDER>21</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><R3RELEASE>750</R3RELEASE><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_REFRESH_DATA</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>22</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-13</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><R3RELEASE>750</R3RELEASE><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>SET_REFRESH_DATA</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>23</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-13</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON><MTDTYPE>0</MTDTYPE><MTDDECLTYP>0</MTDDECLTYP><R3RELEASE>750</R3RELEASE><BCMTDCAT>00</BCMTDCAT><BCMTDSYN>0</BCMTDSYN></item></METHODS><EVENTS><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>ON_USER_COMMAND</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>1</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><EVTDECLTYP>0</EVTDECLTYP><BCEVTCAT>00</BCEVTCAT></item></EVENTS><TYPES><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_S_DATA_SEL2</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>1</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>10</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>17</SRCROW2><SRCCOLUMN2>31</SRCCOLUMN2><TYPESRC_LENG>296</TYPESRC_LENG><TYPESRC>BEGIN OF ty_s_data_sel2.
        INCLUDE TYPE zpp_cruscotto_mag_sel2.
*        INCLUDE TYPE mspr.
*    TYPES:   maktx TYPE makt-maktx.
*    TYPES:   qta   TYPE mspr-prlab.
*    TYPES:   lgort_from TYPE t001l-lgort.
*    TYPES:   lgort_to TYPE mard-lgort.
    TYPES: END OF ty_s_data_sel2
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_DATA_SEL2</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>2</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>19</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>19</SRCROW2><SRCCOLUMN2>46</SRCCOLUMN2><TYPESRC_LENG>45</TYPESRC_LENG><TYPESRC>ty_t_data_sel2 TYPE TABLE OF ty_s_data_sel2
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_S_ALV_SEL2</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>3</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>21</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>26</SRCROW2><SRCCOLUMN2>30</SRCCOLUMN2><TYPESRC_LENG>219</TYPESRC_LENG><TYPESRC>BEGIN OF  ty_s_alv_sel2.
    TYPES:   ligth TYPE icon-id.
        INCLUDE TYPE ty_s_data_sel2.
*    TYPES:   esito TYPE zdbc_esito.
*    TYPES:   descr_esito TYPE zdbc_descr_esito.
    TYPES: END OF ty_s_alv_sel2
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_ALV_SEL2</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>4</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>28</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>28</SRCROW2><SRCCOLUMN2>44</SRCCOLUMN2><TYPESRC_LENG>43</TYPESRC_LENG><TYPESRC>ty_t_alv_sel2 TYPE TABLE OF ty_s_alv_sel2
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_BAPI_ORDER_HEADER1</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>5</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>30</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>30</SRCROW2><SRCCOLUMN2>59</SRCCOLUMN2><TYPESRC_LENG>58</TYPESRC_LENG><TYPESRC>ty_t_bapi_order_header1 TYPE TABLE OF bapi_order_header1
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_BAPI_ORDER_ITEM</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>6</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>32</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>32</SRCROW2><SRCCOLUMN2>72</SRCCOLUMN2><TYPESRC_LENG>71</TYPESRC_LENG><TYPESRC>ty_t_bapi_order_item              TYPE TABLE OF       bapi_order_item
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_BAPI_ORDER_SEQUENCE</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>7</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>34</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>34</SRCROW2><SRCCOLUMN2>76</SRCCOLUMN2><TYPESRC_LENG>75</TYPESRC_LENG><TYPESRC>ty_t_bapi_order_sequence           TYPE TABLE OF      bapi_order_sequence
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_BAPI_ORDER_OPERATION1</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>8</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>36</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>36</SRCROW2><SRCCOLUMN2>78</SRCCOLUMN2><TYPESRC_LENG>77</TYPESRC_LENG><TYPESRC>ty_t_bapi_order_operation1          TYPE TABLE OF     bapi_order_operation1
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_BAPI_ORDER_TRIGGER_POINT</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>9</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>38</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>38</SRCROW2><SRCCOLUMN2>81</SRCCOLUMN2><TYPESRC_LENG>80</TYPESRC_LENG><TYPESRC>ty_t_bapi_order_trigger_point        TYPE TABLE OF    bapi_order_trigger_point
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_BAPI_ORDER_COMPONENT</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>10</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>40</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>40</SRCROW2><SRCCOLUMN2>77</SRCCOLUMN2><TYPESRC_LENG>76</TYPESRC_LENG><TYPESRC>ty_t_bapi_order_component          TYPE TABLE OF      bapi_order_component
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_BAPI_ORDER_PROD_REL_TOOLS</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>11</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>42</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>42</SRCROW2><SRCCOLUMN2>82</SRCCOLUMN2><TYPESRC_LENG>81</TYPESRC_LENG><TYPESRC>ty_t_bapi_order_prod_rel_tools     TYPE TABLE OF      bapi_order_prod_rel_tools
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_FSH_TT_BAPI_PRODORD_SEASO</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>12</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>44</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>44</SRCROW2><SRCCOLUMN2>81</SRCCOLUMN2><TYPESRC_LENG>80</TYPESRC_LENG><TYPESRC>ty_t_fsh_tt_bapi_prodord_seaso   TYPE TABLE OF      fsh_tt_bapi_prodord_season
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_S_DATA_SEL1</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>13</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>46</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>90</SRCROW2><SRCCOLUMN2>31</SRCCOLUMN2><TYPESRC_LENG>1867</TYPESRC_LENG><TYPESRC>BEGIN OF ty_s_data_sel1.
        INCLUDE TYPE bapi_order_header1.
    TYPES: comp_reservation_number TYPE  rsnum.
    TYPES: reservation_item TYPE  rspos.
    TYPES: reservation_type TYPE  rsart.
    TYPES: deletion_indicator TYPE  xloek.
    TYPES: comp_material TYPE  matnr18.
    TYPES: prod_plant TYPE  werks_d.
    TYPES: storage_location TYPE  lgort_d.
    TYPES: supply_area TYPE	prvbe.
    TYPES: comp_batch  TYPE  charg_d.
    TYPES: special_stock  TYPE  sobkz.
    TYPES: req_date TYPE  bdter.
    TYPES: req_quan TYPE  bdmng.
    TYPES: base_uom TYPE  meins.
    TYPES: base_uom_iso TYPE  isocd_unit.
    TYPES: withdrawn_quantity TYPE  enmng.
    TYPES: entry_quantity TYPE  erfmg.
    TYPES: entry_uom  TYPE  erfme.
    TYPES: entry_uom_iso  TYPE  isocd_unit.
    TYPES: comp_order_number TYPE  aufnr.
    TYPES: movement_type TYPE	bwart.
    TYPES: item_category  TYPE  postp.
    TYPES: item_number  TYPE  aposn.
    TYPES: sequence TYPE  plnfolge.
    TYPES: operation  TYPE  vornr.
    TYPES: backflush  TYPE  rgekz.
    TYPES: valuation_spec_stock TYPE  kzbws.
    TYPES: comp_system_status  TYPE  statxt.
    TYPES: material_description TYPE  maktx.
    TYPES: commited_quantity  TYPE  co_vmeng.
    TYPES: shortage TYPE  co_fmeng.
    TYPES: purchase_req_no  TYPE  banfn.
    TYPES: purchase_req_item  TYPE  bnfpo.
    TYPES: comp_material_external  TYPE  mgv_material_external.
    TYPES: comp_material_guid  TYPE  mgv_material_guid.
    TYPES: comp_material_version TYPE  mgv_material_version.
    TYPES: req_segment  TYPE  sgt_rcat.
    TYPES: stock_segment  TYPE  sgt_scat.
    TYPES: comp_material_long  TYPE  matnr40.
    TYPES: lgort_from TYPE mseg-lgort.
    TYPES: lgort_to TYPE mseg-lgort.
    TYPES: labst TYPE mard-labst .
    TYPES: prlab TYPE mspr-prlab.
    TYPES: END OF ty_s_data_sel1
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_S_ALV_SEL1</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>14</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>92</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>99</SRCROW2><SRCCOLUMN2>30</SRCCOLUMN2><TYPESRC_LENG>317</TYPESRC_LENG><TYPESRC>BEGIN OF  ty_s_alv_sel1.
    TYPES:   ligth TYPE icon-id.
        INCLUDE TYPE ty_s_data_sel1.
    TYPES:   cogi TYPE c LENGTH 1.
    TYPES:   esito TYPE zdbc_esito.
    TYPES:   descr_esito TYPE zdbc_descr_esito..
    TYPES:   scol  TYPE lvc_t_scol. &quot; table for cell coloring
    TYPES: END OF ty_s_alv_sel1
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_ALV_SEL1</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>15</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>101</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>101</SRCROW2><SRCCOLUMN2>44</SRCCOLUMN2><TYPESRC_LENG>43</TYPESRC_LENG><TYPESRC>ty_t_alv_sel1 TYPE TABLE OF ty_s_alv_sel1
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_T_DATA_SEL1</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>16</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>103</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>103</SRCROW2><SRCCOLUMN2>46</SRCCOLUMN2><TYPESRC_LENG>45</TYPESRC_LENG><TYPESRC>ty_t_data_sel1 TYPE TABLE OF ty_s_data_sel1
</TYPESRC></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TY_S_SEL</CMPNAME><VERSION>1</VERSION><LANGU>I</LANGU><EXPOSURE>2</EXPOSURE><STATE>1</STATE><EDITORDER>17</EDITORDER><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-13</CHANGEDON><TYPTYPE>4</TYPTYPE><SRCROW1>105</SRCROW1><SRCCOLUMN1>4</SRCCOLUMN1><SRCROW2>122</SRCROW2><SRCCOLUMN2>20</SRCCOLUMN2><TYPESRC_LENG>1277</TYPESRC_LENG><TYPESRC>BEGIN OF ty_s_sel,
        p_sel1     TYPE abap_bool,   &quot;Gestione impegni aperti
        p_sel2     TYPE abap_bool,   &quot;Gestione giacenze a WBS
        p_sel3     TYPE abap_bool,   &quot;Gestione rientri a magazzino
        p_posid    TYPE prps-posid,  &quot;afpo-projn
        p_mat      TYPE mara-matnr,
        p_werks    TYPE marc-werks,
*        p_lgr_fr TYPE mard-lgort,  &quot;Magazzino di reparto sul quale registrare il carico
        p_lgr_to   TYPE mard-lgort,  &quot;Magazzino centrale sul quale registrare il carico
        p_menge    TYPE menge_d,     &quot;quantit√† per la quale registrare il carico
        p_layout   TYPE disvariant-variant,             &quot;Layout alv
        aufnr      TYPE aufnr,       &quot;campo d&apos;appoggio per passaggio dati a metodo registra_mov.
        bwart      TYPE bwart,       &quot;campo d&apos;appoggio per passaggio dati a metodo registra_mov.
        sobkz      TYPE sobkz,       &quot;campo d&apos;appoggio per passaggio dati a metodo registra_mov.
        meins      TYPE meins,       &quot;campo d&apos;appoggio per passaggio dati a metodo registra_mov.
        lgort_from TYPE mard-lgort, &quot;campo d&apos;appoggio per passaggio dati a metodo registra_mov.
        lgort_to   TYPE mard-lgort, &quot;campo d&apos;appoggio per passaggio dati a metodo registra_mov.
      END OF ty_s_sel
</TYPESRC></item></TYPES><PARAMETERS><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>ALV_SHOW</CMPNAME><SCONAME>IV_TITLE</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>ALV Control: testo della riga titolo</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>LVC_TITLE</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>ALV_SHOW</CMPNAME><SCONAME>CT_DATA</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>2</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TABLE</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>IV_NUMBER</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Numero ordine</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>BAPI_ORDER_KEY-ORDER_NUMBER</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>IV_COLLECTIVE_ORDER</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Vis. network ordini completi</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>2</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>BAPI_ORDER_FUNC_CNTRL-COLLECTIVE_ORDER</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>IV_ORDER_OBJECTS</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Struttura di selezione per oggetti ordine di produzione</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>3</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>BAPI_PP_ORDER_OBJECTS</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>CS_RETURN</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Parametri di ritorno</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>4</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-07</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>BAPIRET2</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>CT_HEADER</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Dati testata ordine</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>5</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-07</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_BAPI_ORDER_HEADER1</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>CT_POSITION</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Posizione ordine</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>6</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-07</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_BAPI_ORDER_ITEM</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>CT_SEQUENCE</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Dati sequenza ordini</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>7</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-07</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_BAPI_ORDER_SEQUENCE</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>CT_OPERATION</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Dati operazione ordine</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>8</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-07</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_BAPI_ORDER_OPERATION1</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>CT_TRIGGER_POINT</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Dati evento chiave</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>9</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-07</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_BAPI_ORDER_TRIGGER_POINT</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>CT_COMPONENT</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Componenti dell&apos;ordine</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>10</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-07</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_BAPI_ORDER_COMPONENT</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>CT_PROD_REL_TOOL</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Dati mezzi e attrezzature produzione</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>11</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-07</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_BAPI_ORDER_PROD_REL_TOOLS</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>CT_FSH_PRODORD_SEASON</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Table type of season in production order bapi</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>12</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-07</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_FSH_TT_BAPI_PRODORD_SEASO</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>BAPI_PRODORD_GET_DETAIL</CMPNAME><SCONAME>RV_RET</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>13</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>3</PARDECLTYP><PARPASSTYP>0</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>ABAP_BOOL</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CHECK_REQ_FIELDS</CMPNAME><SCONAME>RV_RET</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-06</CHANGEDON><PARDECLTYP>3</PARDECLTYP><PARPASSTYP>0</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>ABAP_BOOL</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CLOSE_REQ</CMPNAME><SCONAME>IT_ROWS</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Righe</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SALV_T_ROW</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CONSTRUCTOR</CMPNAME><SCONAME>IV_PROGRAM</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Programma chiamante</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>2</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SY-REPID</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CONSTRUCTOR</CMPNAME><SCONAME>IV_LANGUAGE</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Campo sistema ABAP: chiave lingua dell&apos;ambiente testi</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>2</MTDTYPE><EDITORDER>2</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SY-LANGU</TYPE><PARVALUE>SY-LANGU</PARVALUE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CONSTRUCTOR</CMPNAME><SCONAME>IV_PFSTATUS</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Stato GUI</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>2</MTDTYPE><EDITORDER>3</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SYPFKEY</TYPE><PARVALUE>SPACE</PARVALUE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CONSTRUCTOR</CMPNAME><SCONAME>IV_PFSTATUS2</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Stato GUI</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>2</MTDTYPE><EDITORDER>4</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SYPFKEY</TYPE><PARVALUE>SPACE</PARVALUE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>CONS_GIAC</CMPNAME><SCONAME>IT_ROWS</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Righe</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SALV_T_ROW</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA</CMPNAME><SCONAME>IS_SEL</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_S_SEL</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA</CMPNAME><SCONAME>CT_DATA_SEL1</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>2</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_DATA_SEL1</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA</CMPNAME><SCONAME>CT_DATA_SEL2</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>3</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-08</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_DATA_SEL2</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA_SEL1</CMPNAME><SCONAME>IS_SEL</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_S_SEL</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA_SEL1</CMPNAME><SCONAME>CT_DATA</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>2</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-08</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_DATA_SEL1</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA_SEL2</CMPNAME><SCONAME>IS_SEL</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_S_SEL</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_DATA_SEL2</CMPNAME><SCONAME>CT_DATA</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>2</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-08</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_DATA_SEL2</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_REFRESH_DATA</CMPNAME><SCONAME>RV_REFRESH_DATA</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-13</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>3</PARDECLTYP><PARPASSTYP>0</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>ABAP_BOOL</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>GET_SALV</CMPNAME><SCONAME>EO_SALV</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Classe gestione alv grid</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>3</PARDECLTYP><PARPASSTYP>0</PARPASSTYP><TYPTYPE>3</TYPTYPE><TYPE>ZCL_BC_ALV_BASE</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>LOAD_GIAC</CMPNAME><SCONAME>IT_ROWS</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Righe</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SALV_T_ROW</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>MOVE_BAPI_TO_LOCAL</CMPNAME><SCONAME>IT_HEADER</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_BAPI_ORDER_HEADER1</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>MOVE_BAPI_TO_LOCAL</CMPNAME><SCONAME>IT_COMPONENT</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>2</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_BAPI_ORDER_COMPONENT</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>MOVE_BAPI_TO_LOCAL</CMPNAME><SCONAME>CT_DATA</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>3</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-08</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_T_DATA_SEL1</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>ON_USER_COMMAND</CMPNAME><SCONAME>E_SALV_FUNCTION</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>General Events</DESCRIPT><CMPTYPE>2</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>1</PARDECLTYP><PARPASSTYP>0</PARPASSTYP><TYPTYPE>3</TYPTYPE><TYPE>CL_SALV_EVENTS</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>PREL_COMP</CMPNAME><SCONAME>IT_ROWS</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Righe</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-07</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SALV_T_ROW</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>REGISTRA_MOV</CMPNAME><SCONAME>IS_SEL</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>TY_S_SEL</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>REGISTRA_MOV</CMPNAME><SCONAME>CV_ESITO</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Codice esito</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>2</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-08</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>ZDBC_ESITO</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>REGISTRA_MOV</CMPNAME><SCONAME>CV_DESCR_ESITO</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Descrizione esito</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>3</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDBY>KOSMEDEV</CHANGEDBY><CHANGEDON>2016-09-08</CHANGEDON><PARDECLTYP>2</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>ZDBC_DESCR_ESITO</TYPE><PAROPTIONL>X</PAROPTIONL></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>SCARICA_GIAC</CMPNAME><SCONAME>IT_ROWS</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Righe</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SALV_T_ROW</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>SET_REFRESH_DATA</CMPNAME><SCONAME>IV_REFRESH_DATA</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-13</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>ABAP_BOOL</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>SET_SALV</CMPNAME><SCONAME>IO_SALV</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Classe gestione alv grid</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>3</TYPTYPE><TYPE>ZCL_BC_ALV_BASE</TYPE></item><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><CMPNAME>TRASF_GIAC</CMPNAME><SCONAME>IT_ROWS</SCONAME><VERSION>1</VERSION><LANGU>I</LANGU><DESCRIPT>Righe</DESCRIPT><CMPTYPE>1</CMPTYPE><MTDTYPE>0</MTDTYPE><EDITORDER>1</EDITORDER><DISPID>0</DISPID><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-08</CREATEDON><CHANGEDON>0000-00-00</CHANGEDON><PARDECLTYP>0</PARDECLTYP><PARPASSTYP>1</PARPASSTYP><TYPTYPE>1</TYPTYPE><TYPE>SALV_T_ROW</TYPE></item></PARAMETERS><EXCEPTIONS/><IMPLEMENTINGS/><IMPL_DETAILS/><FRIENDSHIPS/><TYPEPUSAGES><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><TYPEGROUP>ABAP</TYPEGROUP><VERSION>1</VERSION><TPUTYPE>0</TPUTYPE><IMPLICIT>X</IMPLICIT></item></TYPEPUSAGES><CLSDEFERRDS><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><TYPEGROUP>ZCL_PP_PDM_FILE</TYPEGROUP><VERSION>1</VERSION><TPUTYPE>1</TPUTYPE><IMPLICIT>X</IMPLICIT></item></CLSDEFERRDS><INTDEFERRDS/><ALIASES/><INHERITANCE><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><REFCLSNAME>ZCL_BC_PROGRAM_BASE</REFCLSNAME><VERSION>1</VERSION><STATE>1</STATE><AUTHOR>KOSMEDEV</AUTHOR><CREATEDON>2016-09-06</CREATEDON><CHANGEDON>2016-09-13</CHANGEDON></INHERITANCE><INTERFACES/><REDEFINITIONS><item><CLSNAME>ZCL_PP_CRUSCOTTO_MAG</CLSNAME><REFCLSNAME>ZCL_BC_PROGRAM_BASE</REFCLSNAME><VERSION>1</VERSION><MTDNAME>MODIFY_SCREEN</MTDNAME><EXPOSURE>2</EXPOSURE></item></REDEFINITIONS><TYPE_SOURCE/><LOCALS_SRC/><LOCALS_DEF><item>*&quot;* use this source file for any type of declarations (class</item><item>*&quot;* definitions, interfaces or type declarations) you need for</item><item>*&quot;* components in the private section</item><item/></LOCALS_DEF><LOCALS_IMP><item>*&quot;* use this source file for the definition and implementation of</item><item>*&quot;* local helper classes, interface definitions and type</item><item>*&quot;* declarations</item><item/><item>CLASS lcl_alv DEFINITION INHERITING FROM cl_salv_controller_table ABSTRA</item><item>  PUBLIC SECTION.</item><item>    CLASS-METHODS: get_grid</item><item>      IMPORTING iref_salv       TYPE REF TO cl_salv_table</item><item>      RETURNING VALUE(ret_grid) TYPE REF TO cl_gui_alv_grid.</item><item/><item/><item>ENDCLASS.                    &quot;lcl_alv DEFINITION</item><item/><item>CLASS lcl_alv IMPLEMENTATION.</item><item>  METHOD get_grid. &quot; to get the ref. of the instance cl_gui_alv_grid in</item><item>    DATA: r_controller TYPE REF TO   cl_salv_controller_table,</item><item>          r_adapter    TYPE REF TO   cl_salv_fullscreen_adapter.</item><item/><item/><item>    TRY.</item><item>        r_controller    ?=    iref_salv-&gt;r_controller.</item><item>        r_adapter       ?=    r_controller-&gt;r_adapter.</item><item>        ret_grid         =    r_adapter-&gt;get_grid( ).</item><item/><item/><item>      CATCH cx_root.</item><item>        &quot; ERROR HANDLER TO DO ( if you want )</item><item>    ENDTRY.</item><item/><item/><item>  ENDMETHOD.                    &quot;get_grid</item><item>ENDCLASS.                    &quot;lcl_alv IMPLEMENTATION</item><item/><item>CLASS lcl_handle_events DEFINITION.</item><item>  PUBLIC SECTION.</item><item>    METHODS:</item><item>      constructor IMPORTING io_sender TYPE REF TO zcl_pp_cruscotto_mag</item><item>                            io_alv    TYPE REF TO cl_salv_table</item><item>                            io_sel    TYPE REF TO cl_salv_selections,</item><item>      edit,</item><item>      on_user_command FOR EVENT added_function OF cl_salv_events</item><item>        IMPORTING e_salv_function.</item><item>  PRIVATE SECTION.</item><item>    DATA: go_sender TYPE REF TO zcl_pp_cruscotto_mag,</item><item>          go_alv    TYPE REF TO cl_salv_table,</item><item>          go_sel    TYPE REF TO cl_salv_selections.</item><item>*    METHODS:</item><item>*      edit.</item><item>ENDCLASS.</item><item/><item>CLASS lcl_handle_events IMPLEMENTATION.</item><item>  METHOD constructor.</item><item>    go_sender = io_sender.</item><item>    go_alv = io_alv.</item><item>    go_sel = io_sel.</item><item>  ENDMETHOD.</item><item>  METHOD on_user_command.</item><item>    DATA: lo_selections TYPE REF TO cl_salv_selections,</item><item>          lo_salv       TYPE REF TO cl_salv_table.</item><item>    DATA: lt_rows TYPE salv_t_row.</item><item>    DATA: ls_rows TYPE i.</item><item>    DATA: message TYPE string.</item><item>    CASE e_salv_function.</item><item>      WHEN &apos;CLOSE&apos;.</item><item>        go_sender-&gt;close_req( EXPORTING it_rows = go_sel-&gt;get_selected_r</item><item>*        go_sender-&gt;refresh( ).</item><item>*        go_alv-&gt;refresh( refresh_mode = if_salv_c_refresh=&gt;full ).</item><item>      WHEN &apos;PREL&apos;.</item><item>        go_sender-&gt;prel_comp( EXPORTING it_rows = go_sel-&gt;get_selected_r</item><item>*        go_sender-&gt;refresh( ).</item><item>*        go_alv-&gt;refresh( refresh_mode = if_salv_c_refresh=&gt;full ).</item><item>      WHEN &apos;LOAD&apos;.</item><item>        go_sender-&gt;load_giac( EXPORTING it_rows = go_sel-&gt;get_selected_r</item><item>*        go_sender-&gt;refresh( ).</item><item>*        go_alv-&gt;refresh( refresh_mode = if_salv_c_refresh=&gt;full ).</item><item>      WHEN &apos;UNLOAD&apos;.</item><item>        go_sender-&gt;scarica_giac( EXPORTING it_rows = go_sel-&gt;get_selecte</item><item>*        go_sender-&gt;refresh( ).</item><item>*        go_alv-&gt;refresh( refresh_mode = if_salv_c_refresh=&gt;full ).</item><item>      WHEN &apos;TRASF&apos;.</item><item>        go_sender-&gt;trasf_giac( EXPORTING it_rows = go_sel-&gt;get_selected_</item><item>*        go_sender-&gt;refresh( ).</item><item>*        go_alv-&gt;refresh( refresh_mode = if_salv_c_refresh=&gt;full ).</item><item>      WHEN &apos;CONS&apos;.</item><item>        go_sender-&gt;cons_giac( EXPORTING it_rows = go_sel-&gt;get_selected_r</item><item>*        go_sender-&gt;refresh( ).</item><item>*        go_alv-&gt;refresh( refresh_mode = if_salv_c_refresh=&gt;full ).</item><item>      WHEN &apos;REFRESH&apos;.</item><item>        go_sender-&gt;set_refresh_data( abap_true ).</item><item>        go_sender-&gt;refresh_data( ).</item><item>        go_alv-&gt;refresh( refresh_mode = if_salv_c_refresh=&gt;full ).</item><item>      WHEN &apos;EDIT&apos;.</item><item>        edit( ).</item><item>      WHEN &apos;&amp;&amp;BACK&apos;.</item><item>        LEAVE TO SCREEN 0.</item><item>    ENDCASE.</item><item>    TRY.</item><item>        IF ( go_sender-&gt;get_refresh_data( ) = abap_true ).</item><item>          go_sender-&gt;refresh_data( ).</item><item>        ENDIF.</item><item>        go_alv-&gt;refresh( refresh_mode = if_salv_c_refresh=&gt;full ).</item><item>      CATCH cx_root.</item><item>    ENDTRY.</item><item>  ENDMETHOD.</item><item>  METHOD edit.</item><item>    DATA: r_cl_gui        TYPE REF TO cl_gui_alv_grid,</item><item>          lo_full_adap    TYPE REF TO cl_salv_fullscreen_adapter,</item><item>          lt_fieldcatalog TYPE lvc_t_fcat,</item><item>          lv_select_date  TYPE gkday,</item><item>          lv_bool         TYPE abap_bool.</item><item>    IF r_cl_gui IS NOT BOUND.</item><item>      r_cl_gui = lcl_alv=&gt;get_grid( go_alv ).</item><item>      r_cl_gui-&gt;get_frontend_fieldcatalog( IMPORTING et_fieldcatalog = l</item><item>      LOOP AT lt_fieldcatalog INTO DATA(wa_fieldcatalog).</item><item>        IF ( wa_fieldcatalog-edit = abap_false ).</item><item>          lv_bool = abap_true.</item><item>        ELSE.</item><item>          lv_bool = abap_false.</item><item>        ENDIF.</item><item>        CASE wa_fieldcatalog-fieldname.</item><item>          WHEN &apos;LABST&apos;.</item><item>*            wa_fieldcatalog-edit = lv_bool.</item><item>            wa_fieldcatalog-no_zero = abap_true.</item><item>            MODIFY lt_fieldcatalog FROM wa_fieldcatalog.</item><item>          WHEN &apos;PRLAB&apos;.</item><item>*            wa_fieldcatalog-edit = lv_bool.</item><item>            wa_fieldcatalog-no_zero = abap_true.</item><item>            MODIFY lt_fieldcatalog FROM wa_fieldcatalog.</item><item>          WHEN &apos;QTA&apos;.</item><item>            wa_fieldcatalog-edit = lv_bool.</item><item>            wa_fieldcatalog-no_zero = abap_true.</item><item>            MODIFY lt_fieldcatalog FROM wa_fieldcatalog.</item><item>          WHEN &apos;LGORT_FROM&apos;.</item><item>            wa_fieldcatalog-edit = lv_bool.</item><item>            wa_fieldcatalog-ref_field = &apos;LGORT&apos;.</item><item>            wa_fieldcatalog-ref_table = &apos;MARD&apos;.</item><item>            wa_fieldcatalog-tabname = &apos;GT_ALV_SEL2&apos;.</item><item>            MODIFY lt_fieldcatalog FROM wa_fieldcatalog.</item><item>          WHEN &apos;LGORT_TO&apos;.</item><item>            wa_fieldcatalog-edit = lv_bool.</item><item>            wa_fieldcatalog-ref_field = &apos;LGORT&apos;.</item><item>            wa_fieldcatalog-ref_table = &apos;MARD&apos;.</item><item>            MODIFY lt_fieldcatalog FROM wa_fieldcatalog.</item><item>          WHEN &apos;COGI&apos;.</item><item>            wa_fieldcatalog-checkbox = abap_true.</item><item>            MODIFY lt_fieldcatalog FROM wa_fieldcatalog.</item><item>        ENDCASE.</item><item>      ENDLOOP.</item><item>      r_cl_gui-&gt;set_frontend_fieldcatalog( EXPORTING it_fieldcatalog = l</item><item>      r_cl_gui-&gt;register_edit_event( EXPORTING i_event_id = cl_gui_alv_g</item><item>      r_cl_gui-&gt;register_edit_event( EXPORTING i_event_id = cl_gui_alv_g</item><item>      r_cl_gui-&gt;refresh_table_display( ). &quot;must after cahnge the fieldca</item><item>    ENDIF.</item><item>  ENDMETHOD.</item><item>ENDCLASS.</item><item/><item>CLASS lcl_alv_om_tool DEFINITION INHERITING FROM cl_salv_controller.</item><item>  PUBLIC SECTION.</item><item>    CLASS-METHODS set_editable IMPORTING io_alv      TYPE REF TO cl_salv</item><item>                                         iv_editable TYPE abap_bool.</item><item>ENDCLASS.</item><item/><item>CLASS lcl_alv_om_tool IMPLEMENTATION.</item><item>  METHOD set_editable.</item><item>    DATA ls_layout      TYPE lvc_s_layo.</item><item>    DATA lo_full_adap   TYPE REF TO cl_salv_fullscreen_adapter.</item><item>    DATA lo_grid        TYPE REF TO cl_gui_alv_grid.</item><item/><item>*   Fullscreen Adapter (Down Casting)</item><item>    lo_full_adap ?= io_alv-&gt;r_controller-&gt;r_adapter.</item><item/><item>*   Get the Grid</item><item>    lo_grid = lo_full_adap-&gt;get_grid( ).</item><item/><item>    IF lo_grid IS NOT BOUND.</item><item>      RETURN.</item><item>    ENDIF.</item><item/><item>*   Editable ALV</item><item>    ls_layout-edit = &apos;X&apos;.</item><item/><item>*   Set the front layout of ALV</item><item>    CALL METHOD lo_grid-&gt;set_frontend_layout</item><item>      EXPORTING</item><item>        is_layout = ls_layout.</item><item/><item>*   refresh the table</item><item>    CALL METHOD lo_grid-&gt;refresh_table_display.</item><item>  ENDMETHOD.                    &quot;set_editable</item><item>ENDCLASS.</item></LOCALS_IMP><LOCALS_MAC><item>*&quot;* use this source file for any macro definitions you need</item><item>*&quot;* in the implementation part of the class</item><item/></LOCALS_MAC><TEXT_POOL><I><item><ID>I</ID><KEY>001</KEY><ENTRY>Anagrafica Materiale Filling</ENTRY><LENGTH>56</LENGTH></item><item><ID>I</ID><KEY>002</KEY><ENTRY>Anagrafica Materiale Labelling</ENTRY><LENGTH>60</LENGTH></item><item><ID>I</ID><KEY>004</KEY><ENTRY>Anagrafica Materiale Packaging</ENTRY><LENGTH>60</LENGTH></item><item><ID>I</ID><KEY>005</KEY><ENTRY>Distinte base Filling</ENTRY><LENGTH>42</LENGTH></item><item><ID>I</ID><KEY>006</KEY><ENTRY>Distinte base Labelling</ENTRY><LENGTH>46</LENGTH></item><item><ID>I</ID><KEY>007</KEY><ENTRY>Distinte base Packaging</ENTRY><LENGTH>46</LENGTH></item><item><ID>I</ID><KEY>008</KEY><ENTRY>Anagrafica Materiale</ENTRY><LENGTH>40</LENGTH></item><item><ID>I</ID><KEY>009</KEY><ENTRY>Distinte base</ENTRY><LENGTH>23</LENGTH></item><item><ID>I</ID><KEY>010</KEY><ENTRY>Files elaborati!</ENTRY><LENGTH>26</LENGTH></item><item><ID>I</ID><KEY>011</KEY><ENTRY>Errori trasmissioni Anagrafica Materiale</ENTRY><LENGTH>80</LENGTH></item><item><ID>I</ID><KEY>012</KEY><ENTRY>Livello non creato per mancanza codice materiale</ENTRY><LENGTH>96</LENGTH></item><item><ID>I</ID><KEY>013</KEY><ENTRY>Codice padre non aperto su divisione</ENTRY><LENGTH>72</LENGTH></item><item><ID>I</ID><KEY>014</KEY><ENTRY>Errore creazione testata diba</ENTRY><LENGTH>42</LENGTH></item><item><ID>I</ID><KEY>015</KEY><ENTRY>Errore cancellazione componenti diba</ENTRY><LENGTH>72</LENGTH></item><item><ID>I</ID><KEY>016</KEY><ENTRY>Log trasmissione BOM</ENTRY><LENGTH>46</LENGTH></item><item><ID>I</ID><KEY>017</KEY><ENTRY>Log trasmissione Anagrafica Materiale</ENTRY><LENGTH>74</LENGTH></item><item><ID>I</ID><KEY>018</KEY><ENTRY>Nessuna parametrizzazione per materiale</ENTRY><LENGTH>78</LENGTH></item><item><ID>I</ID><KEY>019</KEY><ENTRY>Posizione gi√† elaborata</ENTRY><LENGTH>46</LENGTH></item><item><ID>I</ID><KEY>020</KEY><ENTRY>Posizione cancellata</ENTRY><LENGTH>40</LENGTH></item><item><ID>I</ID><KEY>021</KEY><ENTRY>Posizione stornata</ENTRY><LENGTH>28</LENGTH></item></I></TEXT_POOL><METHOD_SOURCE><ALV_SHOW><item>  METHOD alv_show.</item><item>*    IF ( NOT ct_data[] IS INITIAL ).</item><item>    DATA: lt_fieldcat TYPE slis_t_fieldcat_alv,</item><item>          is_print    TYPE slis_print_alv,</item><item>          lv_program  TYPE sy-repid.</item><item>    FIELD-SYMBOLS &lt;ct_data&gt; TYPE table.</item><item/><item>    lv_program = get_program( ).</item><item/><item>    ASSIGN (&apos;CT_DATA[]&apos;) TO &lt;ct_data&gt;.</item><item/><item>    DATA lo_alv     TYPE REF TO cl_salv_table.</item><item>    DATA lo_display TYPE REF TO cl_salv_display_settings.</item><item>    DATA: lt_fcat   TYPE lvc_t_fcat.</item><item/><item>    DATA: lv_lenght   TYPE i.</item><item>    DATA: lv_title    TYPE char70.</item><item/><item>    lo_alv = get_alv( ).</item><item/><item>    TRY.</item><item>        cl_salv_table=&gt;factory( IMPORTING r_salv_table = lo_alv</item><item>                                CHANGING  t_table      = &lt;ct_data&gt; ).</item><item>        DATA: lr_columns      TYPE REF TO cl_salv_columns_list,</item><item>              lr_aggregations TYPE REF TO cl_salv_aggregations.</item><item>*        lt_fcat = cl_salv_controller_metadata=&gt;get_lvc_fieldcatalog(</item><item>*                    r_columns      = lo_alv-&gt;get_columns( ) &quot; ALV Filte</item><item>*                    r_aggregations = lo_alv-&gt;get_aggregations( ) ).&quot; AL</item><item>        lr_columns = lo_alv-&gt;get_columns( ).</item><item>        lr_aggregations = lo_alv-&gt;get_aggregations( ).</item><item>        lt_fcat = cl_salv_controller_metadata=&gt;get_lvc_fieldcatalog(</item><item>                    r_columns      = lr_columns &quot; ALV Filter</item><item>                    r_aggregations = lr_aggregations ).&quot; ALV Aggregation</item><item>        LOOP AT lt_fcat INTO DATA(ls_fcat).&quot; WHERE fieldname = &apos;LABST&apos; O</item><item>          &quot;      fieldname = &apos;PRLAB&apos; OR</item><item>          &quot;     fieldname = &apos;LGORT_FROM&apos; OR</item><item>          &quot;      fieldname = &apos;LGORT_TO&apos;.</item><item>          CASE abap_true.</item><item>            WHEN gs_sel-p_sel1.</item><item>              CASE ls_fcat-fieldname.</item><item>                WHEN &apos;LABST&apos; OR &apos;PRLAB&apos;.</item><item>                  ls_fcat-no_zero  = abap_true.</item><item>                  ls_fcat-quantity = &apos;BASE_UOM&apos;.</item><item>                WHEN &apos;LGORT_FROM&apos; OR &apos;LGORT_TO&apos;.</item><item>                  ls_fcat-no_out = abap_true.</item><item>              ENDCASE.</item><item>            WHEN gs_sel-p_sel2.</item><item>              CASE ls_fcat-fieldname.</item><item>                WHEN &apos;LABST&apos;.</item><item>                  ls_fcat-edit   = abap_false.</item><item>                  ls_fcat-no_out = abap_true.</item><item>                WHEN &apos;PRLAB&apos;.</item><item>*                  ls_fcat-edit     = abap_true.</item><item>                  ls_fcat-no_zero  = abap_true.</item><item>*                  ls_fcat-quantity = &apos;BASE_UOM&apos;.</item><item>                WHEN &apos;QTA&apos;.</item><item>                  ls_fcat-edit     = abap_true.</item><item>                  ls_fcat-no_zero  = abap_true.</item><item>                WHEN &apos;LGORT_FROM&apos; OR &apos;LGORT_TO&apos;.</item><item>                  ls_fcat-edit = abap_true.</item><item>              ENDCASE.</item><item>            WHEN gs_sel-p_sel3.</item><item>          ENDCASE.</item><item>          MODIFY lt_fcat FROM ls_fcat.</item><item>        ENDLOOP.</item><item>        cl_salv_controller_metadata=&gt;set_lvc_fieldcatalog( EXPORTING t_f</item><item>                                                                     r_c</item><item>                                                                     r_a</item><item>        DATA: ls_layout TYPE lvc_s_layo.</item><item>        cl_salv_controller_metadata=&gt;get_lvc_layout( EXPORTING r_columns</item><item>                                                     CHANGING  s_layout</item><item>        ls_layout-edit_mode = abap_true.</item><item>        cl_salv_controller_metadata=&gt;set_lvc_layout( r_columns = lr_colu</item><item>                                                     s_layout  = ls_layo</item><item/><item/><item>        &quot;        lcl_alv_om_tool=&gt;set_editable( EXPORTING  io_alv      =</item><item>        &quot;                                                  iv_editable =</item><item/><item/><item/><item>*      CATCH cx_salv_msg.</item><item>      CATCH cx_root.</item><item>    ENDTRY.</item><item/><item>    DATA: lo_functions TYPE REF TO cl_salv_functions_list,</item><item>          lo_sel       TYPE REF TO cl_salv_selections.</item><item/><item>    lo_functions = lo_alv-&gt;get_functions( ).</item><item>    lo_functions-&gt;set_all( abap_true ).</item><item/><item>    lo_display = lo_alv-&gt;get_display_settings( ).</item><item>    lo_display-&gt;set_list_header( iv_title ).</item><item>*    lo_display-&gt;set_striped_pattern( cl_salv_display_settings=&gt;true ).</item><item/><item>    TRY.</item><item>        DATA: lv_text TYPE string VALUE &apos;nutton&apos;.</item><item>        lv_text = TEXT-b01.</item><item>        lo_functions-&gt;add_function(</item><item>          name     = &apos;GET_SEL&apos;</item><item>          icon     = &apos;ICON_EXECUTE_OBJECT&apos;</item><item>          text     = lv_text</item><item>          tooltip  = lv_text</item><item>          position = if_salv_c_function_position=&gt;right_of_salv_function</item><item>*      CATCH cx_salv_wrong_call cx_salv_existing cx_salv_method_not_supp</item><item>      CATCH cx_root.</item><item>    ENDTRY.</item><item/><item>    DATA: lo_columns TYPE REF TO cl_salv_columns_table,</item><item>          lo_column  TYPE REF TO cl_salv_column_table. &quot;cl_salv_column..</item><item>    lo_columns = lo_alv-&gt;get_columns( ).</item><item>*    DATA: lo_column    TYPE REF TO cl_salv_column.</item><item>    TRY.</item><item>        lo_columns-&gt;set_optimize( abap_true ).</item><item/><item>*        lo_column-&gt;set_</item><item>*        lo_columns-&gt;set_enabled_column( value = &apos;BUDAT&apos; ).</item><item/><item>*          lo_columns-&gt;set_</item><item>*          lo_column = lo_cols-&gt;get_column( &apos;TYPE&apos; ).</item><item>        lo_column ?= lo_columns-&gt;get_column( &apos;PRLAB&apos; ).</item><item>        lo_column-&gt;set_long_text( &apos;Stock Q&apos; ).</item><item>        lo_column-&gt;set_medium_text( &apos;Stock Q&apos; ).</item><item>        lo_column-&gt;set_short_text( &apos;Stock Q&apos; ).</item><item/><item>        IF ( gs_sel-p_sel1 = abap_true ).</item><item>          lo_column ?= lo_columns-&gt;get_column( &apos;COMP_MATERIAL&apos; ).</item><item>          lo_column-&gt;set_long_text( &apos;Componente&apos; ).</item><item>          lo_column-&gt;set_medium_text( &apos;Componente&apos; ).</item><item>          lo_column-&gt;set_short_text( &apos;Componente&apos; ).</item><item/><item>*          lo_column-&gt;set_output_length( 10 ).</item><item>          lo_column ?= lo_columns-&gt;get_column( &apos;COGI&apos; ).</item><item>          lo_column-&gt;set_long_text( &apos;COGI&apos; ).</item><item>          lo_column-&gt;set_medium_text( &apos;COGI&apos; ).</item><item>          lo_column-&gt;set_short_text( &apos;COGI&apos; ).</item><item>          lo_column-&gt;set_cell_type( if_salv_c_cell_type=&gt;checkbox ).</item><item/><item>          lo_column ?= lo_columns-&gt;get_column( &apos;BACKFLUSH&apos; ).</item><item>          lo_column-&gt;set_cell_type( if_salv_c_cell_type=&gt;checkbox ).</item><item>        ENDIF.</item><item/><item/><item>        IF ( gs_sel-p_sel2 = abap_true ).</item><item>          lo_column ?= lo_columns-&gt;get_column( &apos;LGORT_FROM&apos; ).</item><item>          lo_column-&gt;set_long_text( &apos;Da&apos; ).</item><item>          lo_column-&gt;set_medium_text( &apos;Da&apos; ).</item><item>          lo_column-&gt;set_short_text( &apos;Da&apos; ).</item><item/><item>          lo_column ?= lo_columns-&gt;get_column( &apos;LGORT_TO&apos; ).</item><item>          lo_column-&gt;set_long_text( &apos;A&apos; ).</item><item>          lo_column-&gt;set_medium_text( &apos;A&apos; ).</item><item>          lo_column-&gt;set_short_text( &apos;A&apos; ).</item><item/><item>          lo_column ?= lo_columns-&gt;get_column( &apos;QTA&apos; ).</item><item>          lo_column-&gt;set_long_text( &apos;Q.t√†.&apos; ).</item><item>          lo_column-&gt;set_medium_text( &apos;Q.t√†&apos; ).</item><item>          lo_column-&gt;set_short_text( &apos;Q.t√†&apos; ).</item><item>        ENDIF.</item><item/><item>        lo_columns-&gt;set_color_column( &apos;SCOL&apos; ).</item><item/><item/><item>*      CATCH cx_salv_not_found.                          &quot;#EC NO_HANDLER</item><item>      CATCH cx_root.</item><item>    ENDTRY.</item><item/><item>    DATA: lo_layout  TYPE REF TO cl_salv_layout,</item><item>          ls_variant TYPE slis_vari,</item><item>          lv_layout  TYPE disvariant-variant.</item><item/><item>    CASE abap_true.</item><item>      WHEN gs_sel-p_sel1.</item><item>        lo_alv-&gt;set_screen_status( report        = get_program( )</item><item>                                   pfstatus      = get_pfstatus( )</item><item>                                   set_functions = lo_alv-&gt;c_functions_a</item><item>        lv_layout = &apos;/LAYOUT1&apos;.</item><item/><item>      WHEN gs_sel-p_sel2.</item><item>        lo_alv-&gt;set_screen_status( report        = get_program( )</item><item>                                   pfstatus      = gv_pfstatus2</item><item>                                   set_functions = lo_alv-&gt;c_functions_a</item><item>        lv_layout = &apos;/LAYOUT2&apos;.</item><item/><item>    ENDCASE.</item><item/><item>    lo_layout = lo_alv-&gt;get_layout( ).</item><item>    lo_layout-&gt;set_save_restriction( if_salv_c_layout=&gt;restrict_none ).</item><item/><item>    lo_layout-&gt;set_key( go_salv-&gt;get_key( ) ).</item><item>    TRY.</item><item>        IF ( NOT gs_sel-p_layout IS INITIAL ).</item><item>          lo_layout-&gt;set_initial_layout( gs_sel-p_layout ).</item><item>        ELSE.</item><item>          lo_layout-&gt;set_initial_layout( lv_layout ).</item><item>        ENDIF.</item><item>      CATCH cx_root.</item><item>    ENDTRY.</item><item/><item/><item>*        lo_alv-&gt;set_screen_status( report        = get_program( )</item><item>*                                   pfstatus      = gv_pfstatus_log</item><item>*                                   set_functions = lo_alv-&gt;c_functions_</item><item>*      ENDIF.</item><item/><item>    DATA : lo_selections    TYPE REF TO cl_salv_selections,</item><item>           lo_events        TYPE REF TO cl_salv_events_table,</item><item>           lo_event_handler TYPE REF TO lcl_handle_events.</item><item/><item>    lo_sel = lo_alv-&gt;get_selections( ).</item><item>    lo_sel-&gt;set_selection_mode( if_salv_c_selection_mode=&gt;multiple ).</item><item/><item>    lo_events = lo_alv-&gt;get_event( ).</item><item>    lo_event_handler = NEW #( io_sender = me</item><item>                              io_alv    = lo_alv</item><item>                              io_sel    = lo_sel ).</item><item/><item>    SET HANDLER lo_event_handler-&gt;on_user_command FOR lo_events.</item><item/><item>*    DATA: r_cl_gui        TYPE REF TO cl_gui_alv_grid,</item><item>*          lo_full_adap    TYPE REF TO cl_salv_fullscreen_adapter,</item><item>*          lt_fieldcatalog TYPE lvc_t_fcat,</item><item>*          lv_select_date  TYPE gkday.</item><item>*</item><item>*    IF r_cl_gui IS NOT BOUND.</item><item>*      r_cl_gui = lcl_alv=&gt;get_grid( lo_alv ).</item><item>*      r_cl_gui-&gt;get_frontend_fieldcatalog( IMPORTING et_fieldcatalog =</item><item>*      LOOP AT lt_fieldcatalog INTO DATA(wa_fieldcatalog).</item><item>*        CASE wa_fieldcatalog-fieldname.</item><item>*          WHEN &apos;BUDAT&apos;.</item><item>*            wa_fieldcatalog-edit = &apos;X&apos;.</item><item>*            MODIFY lt_fieldcatalog FROM wa_fieldcatalog.</item><item>*        ENDCASE.</item><item>*      ENDLOOP.</item><item>*      r_cl_gui-&gt;set_frontend_fieldcatalog( EXPORTING it_fieldcatalog =</item><item>*      r_cl_gui-&gt;register_edit_event( EXPORTING i_event_id = cl_gui_alv_</item><item>*      r_cl_gui-&gt;register_edit_event( EXPORTING i_event_id = cl_gui_alv_</item><item>*      r_cl_gui-&gt;refresh_table_display( ). &quot;must after cahnge the fieldc</item><item>*    ENDIF.</item><item/><item>*    lo_alv-&gt;refresh( refresh_mode = if_salv_c_refresh=&gt;full ).</item><item/><item>    IF lo_alv IS BOUND.</item><item>      set_alv( CHANGING co_alv = lo_alv ).</item><item>      lo_alv-&gt;display( ).</item><item>    ENDIF.</item><item>*    ENDIF.</item><item>  ENDMETHOD.</item></ALV_SHOW><CONSTRUCTOR><item>  METHOD constructor.</item><item>    super-&gt;constructor( iv_program  = iv_program</item><item>                        iv_language = iv_language</item><item>                        iv_pfstatus = iv_pfstatus ).</item><item>    gv_pfstatus2 = iv_pfstatus2.</item><item>  ENDMETHOD.</item></CONSTRUCTOR><CREATE_SELECTIONS><item>  METHOD create_selections.</item><item>    DATA: lref_sel TYPE REF TO data.</item><item>    CREATE DATA lref_sel TYPE ty_s_sel.</item><item>    set_selections( CHANGING cref_sel = lref_sel ).</item><item>    FIELD-SYMBOLS: &lt;sel&gt;    TYPE any.</item><item>    ASSIGN lref_sel-&gt;* TO &lt;sel&gt;.</item><item>    IF ( sy-subrc = 0 ).</item><item>      gs_sel = &lt;sel&gt;.</item><item>    ENDIF.</item><item>  ENDMETHOD.</item></CREATE_SELECTIONS><EXECUTE><item>  METHOD execute.</item><item>    create_selections( ).</item><item>    IF ( check_req_fields( ) ).</item><item>      DATA: lv_fabb_singolo TYPE marc-sbdkz.</item><item>      CLEAR lv_fabb_singolo.</item><item>      SELECT SINGLE sbdkz INTO lv_fabb_singolo FROM marc</item><item>             WHERE matnr = gs_sel-p_mat</item><item>             AND   werks = gs_sel-p_werks.</item><item/><item>      CASE abap_true.</item><item>        WHEN gs_sel-p_sel1.</item><item>        WHEN gs_sel-p_sel2.</item><item>        WHEN gs_sel-p_sel3.</item><item>          IF ( lv_fabb_singolo &lt;&gt; &apos;1&apos; ).</item><item>            CLEAR: gs_sel-p_posid.</item><item>          ENDIF.</item><item>      ENDCASE.</item><item/><item>      get_data( EXPORTING is_sel = gs_sel CHANGING ct_data_sel1 = gt_dat</item><item>                                                   ct_data_sel2 = gt_dat</item><item/><item>      CASE abap_true.</item><item>        WHEN gs_sel-p_sel1.</item><item>          alv_show( CHANGING  ct_data = gt_alv_sel1 ).</item><item>        WHEN gs_sel-p_sel2.</item><item>          alv_show( CHANGING  ct_data = gt_alv_sel2 ).</item><item>        WHEN gs_sel-p_sel3.</item><item>          execute_sel3( ).</item><item>      ENDCASE.</item><item>    ENDIF.</item><item>  ENDMETHOD.</item></EXECUTE><GET_DATA><item>  METHOD get_data.</item><item>    gv_refresh_data = abap_false.</item><item>    CASE abap_true.</item><item>      WHEN gs_sel-p_sel1.</item><item>        get_data_sel1( EXPORTING is_sel = is_sel</item><item>                       CHANGING ct_data = ct_data_sel1 ).</item><item>      WHEN gs_sel-p_sel2.</item><item>        get_data_sel2( EXPORTING is_sel = is_sel</item><item>                       CHANGING ct_data = ct_data_sel2 ).</item><item>    ENDCASE.</item><item>  ENDMETHOD.</item></GET_DATA><GET_SALV><item>  method GET_SALV.</item><item>    eo_salv = go_salv.</item><item>  endmethod.</item></GET_SALV><SET_SALV><item>  method SET_SALV.</item><item>    go_salv = io_salv.</item><item>  endmethod.</item></SET_SALV><MODIFY_SCREEN><item>  METHOD modify_screen.</item><item>    create_selections( ).</item><item/><item>    DATA: lv_fabb_singolo TYPE marc-sbdkz.</item><item>    CLEAR lv_fabb_singolo.</item><item>    SELECT SINGLE sbdkz INTO lv_fabb_singolo FROM marc</item><item>           WHERE matnr = gs_sel-p_mat</item><item>           AND   werks = gs_sel-p_werks.</item><item/><item>    CASE abap_true.</item><item>      WHEN gs_sel-p_sel1.</item><item>      WHEN gs_sel-p_sel2.</item><item>      WHEN gs_sel-p_sel3.</item><item>        IF ( lv_fabb_singolo &lt;&gt; &apos;1&apos; ).</item><item>          CLEAR: gs_sel-p_posid.</item><item>        ENDIF.</item><item>    ENDCASE.</item><item/><item>    DATA: lv_field TYPE string.</item><item>    LOOP AT SCREEN INTO DATA(ls_screen).</item><item>      lv_field = ls_screen-name.</item><item>      IF ( ls_screen-group1 = &apos;ME1&apos; ).</item><item>        CASE abap_true.</item><item>          WHEN gs_sel-p_sel1.</item><item>            ls_screen-active = 1.</item><item>            IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>              me-&gt;set_sel_req_field( iv_field = lv_field ).</item><item>            ENDIF.</item><item>          WHEN gs_sel-p_sel2.</item><item>            ls_screen-active = 1.</item><item>            IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>              me-&gt;set_sel_req_field( iv_field = lv_field ).</item><item>            ENDIF.</item><item>          WHEN gs_sel-p_sel3.</item><item>            IF ( lv_fabb_singolo &lt;&gt; &apos;1&apos; ).</item><item>              ls_screen-active = 0.</item><item>              IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>                me-&gt;reset_sel_req_field( iv_field = lv_field ).</item><item>              ENDIF.</item><item>            ELSE.</item><item>              ls_screen-active = 1.</item><item>*              ls_screen-required = 1.</item><item>              IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>                me-&gt;set_sel_req_field( iv_field = lv_field ).</item><item>              ENDIF.</item><item>            ENDIF.</item><item>          WHEN OTHERS.</item><item>            ls_screen-active = 0.</item><item>        ENDCASE.</item><item>        MODIFY screen FROM ls_screen.</item><item>      ENDIF.</item><item>      IF ( ls_screen-group1 = &apos;ME2&apos; ).</item><item>        CASE abap_true.</item><item>          WHEN gs_sel-p_sel3.</item><item>            ls_screen-active = 1.</item><item>            IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>              me-&gt;set_sel_req_field( iv_field = lv_field ).</item><item>            ENDIF.</item><item>          WHEN OTHERS.</item><item>            ls_screen-active = 0.</item><item>            IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>              me-&gt;reset_sel_req_field( iv_field = lv_field ).</item><item>            ENDIF.</item><item>        ENDCASE.</item><item>        MODIFY screen FROM ls_screen.</item><item>      ENDIF.</item><item>      IF ( ls_screen-group1 = &apos;ME3&apos; ).</item><item>        CASE abap_true.</item><item>*          WHEN gs_sel-p_sel2.</item><item>*            ls_screen-active = 1.</item><item>*            IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>*              me-&gt;set_sel_req_field( iv_field = lv_field ).</item><item>*            ENDIF.</item><item>          WHEN gs_sel-p_sel3.</item><item>            IF ( lv_fabb_singolo &lt;&gt; &apos;1&apos; ).</item><item>              ls_screen-active = 10.</item><item>              IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>                me-&gt;reset_sel_req_field( iv_field = lv_field ).</item><item>              ENDIF.</item><item>            ELSE.</item><item>              ls_screen-active = 1.</item><item>              IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>                me-&gt;set_sel_req_field( iv_field = lv_field ).</item><item>              ENDIF.</item><item>            ENDIF.</item><item>          WHEN OTHERS.</item><item>            ls_screen-active = 0.</item><item>            IF ( ls_screen-group3 = &apos;PAR&apos; ).</item><item>              me-&gt;reset_sel_req_field( iv_field = lv_field ).</item><item>            ENDIF.</item><item>        ENDCASE.</item><item>        MODIFY screen FROM ls_screen.</item><item>      ENDIF.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></MODIFY_SCREEN><CHECK_REQ_FIELDS><item>  METHOD check_req_fields.</item><item>    rv_ret = abap_true.</item><item>    DATA: lv_field TYPE c LENGTH 100.</item><item>    FIELD-SYMBOLS: &lt;lv_field&gt; TYPE any.</item><item>    LOOP AT me-&gt;gt_sel_req_fields INTO DATA(ls_sel_req_field) WHERE requ</item><item>      lv_field = &apos;gs_sel-&apos; &amp;&amp; ls_sel_req_field-field.</item><item>      ASSIGN (lv_field) TO &lt;lv_field&gt;.</item><item>      IF ( sy-subrc = 0 ).</item><item>        IF ( &lt;lv_field&gt; IS INITIAL ).</item><item>          IF ( sy-batch = abap_false ).</item><item>*            IF ( NOT ls_sel_req_field-description IS INITIAL ).</item><item>*              MESSAGE s398(00) WITH ls_sel_req_field-description &apos;obbli</item><item>*            ELSE.</item><item>*              MESSAGE s398(00) WITH ls_sel_req_field-field &apos;obbligaorio</item><item>              MESSAGE s398(00) WITH &apos;Valorizzare i campi obbligatori&apos;..</item><item>*            ENDIF.</item><item>          ENDIF.</item><item>          rv_ret = abap_false.</item><item>        ENDIF.</item><item>      ENDIF.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></CHECK_REQ_FIELDS><BAPI_PRODORD_GET_DETAIL><item>  METHOD bapi_prodord_get_detail.</item><item>    CLEAR: cs_return.</item><item>    REFRESH: ct_header,</item><item>             ct_position,</item><item>             ct_sequence,</item><item>             ct_operation,</item><item>             ct_trigger_point,</item><item>             ct_component,</item><item>             ct_prod_rel_tool.</item><item/><item>    rv_ret = abap_true.</item><item/><item>    CALL FUNCTION &apos;BAPI_PRODORD_GET_DETAIL&apos;</item><item>      EXPORTING</item><item>        number           = iv_number</item><item>        collective_order = iv_collective_order</item><item>        order_objects    = iv_order_objects</item><item>      IMPORTING</item><item>        return           = cs_return</item><item>      TABLES</item><item>        header           = ct_header</item><item>        position         = ct_position</item><item>        sequence         = ct_sequence</item><item>        operation        = ct_operation</item><item>        trigger_point    = ct_trigger_point</item><item>        component        = ct_component</item><item>        prod_rel_tool    = ct_prod_rel_tool.</item><item>    IF ( cs_return-type = &apos;E&apos; OR cs_return-type = &apos;A&apos; ).</item><item>      rv_ret = abap_false.</item><item>    ENDIF.</item><item>  ENDMETHOD.</item></BAPI_PRODORD_GET_DETAIL><GET_DATA_SEL1><item>  METHOD get_data_sel1.</item><item>    DATA: lt_afpo          TYPE TABLE OF afpo,</item><item>          ls_order_objects TYPE bapi_pp_order_objects,</item><item>          ls_return        TYPE bapiret2,</item><item>          lt_header        TYPE ty_t_bapi_order_header1,</item><item>          lt_component     TYPE ty_t_bapi_order_component,</item><item>          lv_pspnr         TYPE afpo-projn,</item><item>          lv_kzear         TYPE resb-kzear,</item><item>          lv_dumps         TYPE resb-dumps,</item><item>          lv_tabix         TYPE i.</item><item/><item>    REFRESH: gt_data_sel1, gt_alv_sel1.</item><item/><item>*   lv_projn = is_sel-p_posid.</item><item>    zcl_bc_conversion_exit=&gt;conversion_input( EXPORTING iv_field = is_se</item><item>                                              CHANGING  cv_field = lv_ps</item><item>    SELECT * INTO CORRESPONDING FIELDS OF TABLE lt_afpo FROM afpo</item><item>             WHERE projn = lv_pspnr &quot;lv_projn.</item><item>                   ORDER BY aufnr.</item><item>    CLEAR: ls_order_objects.</item><item>    ls_order_objects-header = abap_true.</item><item>    ls_order_objects-components = abap_true.</item><item>    LOOP AT lt_afpo INTO DATA(ls_afpo).</item><item>      IF ( bapi_prodord_get_detail( EXPORTING iv_number        = ls_afpo</item><item>                                              iv_order_objects = ls_orde</item><item>                                    CHANGING  cs_return    = ls_return</item><item>                                              ct_header    = lt_header</item><item>                                              ct_component = lt_componen</item><item/><item>        DELETE lt_component WHERE deletion_indicator = abap_true.</item><item/><item>        LOOP AT lt_component INTO DATA(ls_component).</item><item>          lv_tabix = sy-tabix.</item><item>          SELECT SINGLE kzear INTO lv_kzear FROM resb WHERE rsnum = ls_c</item><item>                                             AND   rspos = ls_component-</item><item>                                             AND   rsart = ls_component-</item><item>                                             AND   kzear = abap_true.</item><item>          IF ( sy-subrc = 0 ).</item><item>            DELETE lt_component INDEX lv_tabix.</item><item>            CONTINUE.</item><item>          ENDIF.</item><item>          CLEAR lv_dumps.</item><item>          SELECT SINGLE dumps INTO lv_dumps FROM resb WHERE rsnum = ls_c</item><item>                                             AND   rspos = ls_component-</item><item>                                             AND   rsart = ls_component-</item><item>                                             AND   dumps = abap_true.</item><item>          IF ( sy-subrc = 0 ).</item><item>            DELETE lt_component INDEX lv_tabix.</item><item>            CONTINUE.</item><item>          ENDIF.</item><item/><item>        ENDLOOP.</item><item/><item>        move_bapi_to_local( EXPORTING it_header    = lt_header</item><item>                                      it_component = lt_component</item><item>                            CHANGING  ct_data = ct_data ).</item><item>      ENDIF.</item><item>    ENDLOOP.</item><item/><item>    DATA: ls_alv   TYPE ty_s_alv_sel1,</item><item>          ls_scol  TYPE lvc_s_scol,</item><item>          lv_aufnr TYPE aufnr,</item><item>          lv_int   TYPE lvc_s_colo-int,</item><item>          lv_color TYPE lvc_s_colo-col VALUE 4,</item><item>          ls_affw  TYPE affw.</item><item>    LOOP AT ct_data INTO DATA(ls_data).</item><item>      CLEAR: ls_alv.</item><item>      REFRESH: ls_alv-scol.</item><item>      CLEAR: ls_scol.</item><item>      MOVE-CORRESPONDING ls_data TO ls_alv.</item><item>      ls_scol-color-col = 4.</item><item>      ls_alv-ligth = icon_yellow_light.</item><item>      IF ( lv_aufnr &lt;&gt; ls_alv-order_number ).</item><item>        IF ( lv_int = 1 ).</item><item>          lv_int = 0.</item><item>        ELSE.</item><item>          lv_int = 1.</item><item>        ENDIF.</item><item>      ENDIF.</item><item>      ls_scol-color-col = lv_color.</item><item>      ls_scol-color-int = lv_int.</item><item>      IF ( ls_alv-backflush = abap_true ).</item><item>        ls_scol-color-col = 6.</item><item>        ls_scol-color-int = 0.</item><item>        ls_scol-color-inv = 1.</item><item>      ENDIF.</item><item>      CLEAR: ls_affw.</item><item>      SELECT SINGLE * INTO CORRESPONDING FIELDS OF ls_affw FROM affw</item><item>             WHERE matnr = ls_alv-comp_material</item><item>             AND   rsnum = ls_alv-comp_reservation_number</item><item>             AND   rspos = ls_alv-reservation_item.</item><item>      IF ( sy-subrc = 0 ).</item><item>        ls_alv-cogi = abap_true.</item><item>      ENDIF.</item><item>      APPEND ls_scol TO ls_alv-scol.</item><item>      lv_aufnr = ls_alv-order_number.</item><item>      APPEND ls_alv TO gt_alv_sel1.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></GET_DATA_SEL1><GET_DATA_SEL2><item>  METHOD get_data_sel2.</item><item>    REFRESH: gt_data_sel2, gt_alv_sel2.</item><item/><item>    DATA: lv_posid TYPE ps_psp_pnr. &quot;ty_s_sel-p_posid.</item><item>    zcl_bc_conversion_exit=&gt;conversion_input( EXPORTING iv_field = is_se</item><item>                                              CHANGING cv_field = lv_pos</item><item>    SELECT * INTO CORRESPONDING FIELDS OF TABLE ct_data</item><item>             FROM mspr</item><item>             LEFT JOIN makt ON makt~matnr = mspr~matnr AND</item><item>                               makt~spras = sy-langu</item><item>             WHERE mspr~werks = is_sel-p_werks</item><item>             and   mspr~lgort = &apos;6312&apos;</item><item>             AND   mspr~sobkz = &apos;Q&apos;</item><item>             AND   mspr~pspnr = lv_posid</item><item>             AND   prlab      &gt; 0.</item><item>    DATA: ls_alv TYPE ty_s_alv_sel2.</item><item>    LOOP AT ct_data INTO DATA(ls_data).</item><item>      CLEAR: ls_alv.</item><item>      MOVE-CORRESPONDING ls_data TO ls_alv.</item><item>      ls_alv-lgort_from = ls_data-lgort.</item><item>      ls_alv-ligth = icon_yellow_light.</item><item>      APPEND ls_alv TO gt_alv_sel2.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></GET_DATA_SEL2><CLOSE_REQ><item>  METHOD close_req.</item><item>    DATA: ls_row   TYPE i,</item><item>          ls_data  TYPE ty_s_data_sel1,</item><item>          ls_alv   TYPE ty_s_alv_sel1,</item><item>          lv_tabix TYPE i,</item><item>          lv_err   TYPE abap_bool,</item><item>          lv_kzear TYPE resb-kzear.</item><item/><item>    gv_refresh_data = abap_false.</item><item/><item>    lv_err = abap_false.</item><item>    LOOP AT it_rows INTO ls_row.</item><item>      READ TABLE gt_alv_sel1 INTO ls_alv INDEX ls_row.</item><item>      IF ( sy-subrc = 0 ).</item><item>        lv_tabix = sy-tabix.</item><item>        SELECT SINGLE kzear INTO lv_kzear FROM resb WHERE rsnum = ls_alv</item><item>                                                    AND   rspos = ls_alv</item><item>                                                    AND   rsart = ls_alv</item><item>        CHECK sy-subrc = 0.</item><item>        IF ( lv_kzear IS INITIAL ).</item><item>          UPDATE resb SET kzear = abap_true WHERE rsnum = ls_alv-reserva</item><item>                                            AND   rspos = ls_alv-reserva</item><item>                                            AND   rsart = ls_alv-reserva</item><item>          COMMIT WORK AND WAIT.</item><item>          ls_alv-esito = &apos;000&apos;.</item><item>          ls_alv-descr_esito = &apos;Impegno chiuso&apos;.</item><item>          ls_alv-ligth = icon_green_light.</item><item>          MESSAGE i398(00) WITH &apos;Impegno chiuso&apos;.</item><item>*          DELETE gt_alv_sel1 INDEX lv_tabix.</item><item>          gv_refresh_data = abap_true.</item><item>        ELSE.</item><item>          ls_alv-ligth = icon_red_light.</item><item>          ls_alv-esito = &apos;001&apos;.</item><item>          ls_alv-descr_esito = &apos;Prelievo finale dell&apos;&apos;impegno gi√† effett</item><item>        ENDIF.</item><item>        MODIFY gt_alv_sel1 FROM ls_alv INDEX lv_tabix.</item><item>      ENDIF.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></CLOSE_REQ><LOAD_GIAC><item>  METHOD load_giac.</item><item>    DATA: ls_row   TYPE i,</item><item>          ls_data  TYPE ty_s_data_sel1,</item><item>          ls_alv   TYPE ty_s_alv_sel1,</item><item>          lv_tabix TYPE i,</item><item>          lv_err   TYPE abap_bool,</item><item>          lv_kzear TYPE resb-kzear,</item><item>          ls_sel   TYPE ty_s_sel.</item><item/><item>    gv_refresh_data = abap_false.</item><item>    lv_err = abap_false.</item><item>    LOOP AT it_rows INTO ls_row.</item><item>      READ TABLE gt_alv_sel1 INTO ls_alv INDEX ls_row.</item><item>      IF ( sy-subrc = 0 ).</item><item>        SELECT SINGLE kzear INTO lv_kzear FROM resb WHERE rsnum = ls_alv</item><item>                                            AND   rspos = ls_alv-reserva</item><item>                                            AND   rsart = ls_alv-reserva</item><item>        CHECK sy-subrc = 0.</item><item>        IF ( lv_kzear IS INITIAL ).</item><item>          lv_tabix = sy-tabix.</item><item>          CLEAR: ls_sel.</item><item>          ls_sel-p_mat      = ls_alv-comp_material.</item><item>          ls_sel-aufnr      = ls_alv-order_number.</item><item>          ls_sel-p_werks    = ls_alv-prod_plant.</item><item>          ls_sel-lgort_from = ls_alv-storage_location.</item><item>          ls_sel-bwart      = &apos;561&apos;.</item><item>          ls_sel-sobkz      = ls_alv-special_stock.</item><item>          IF ( ls_alv-special_stock = &apos;Q&apos; ).</item><item>            ls_sel-p_posid  = ls_alv-wbs_element.</item><item>          ENDIF.</item><item>          ls_sel-p_menge    = ls_alv-req_quan - ls_alv-withdrawn_quantit</item><item>          ls_sel-meins      = ls_alv-entry_uom.</item><item>          registra_mov( EXPORTING is_sel = ls_sel</item><item>                        CHANGING cv_esito       = ls_alv-esito</item><item>                                 cv_descr_esito = ls_alv-descr_esito ).</item><item>          IF ( ls_alv-esito = &apos;000&apos; ).</item><item>            ls_alv-ligth = icon_green_light.</item><item/><item>            CLEAR: ls_sel.</item><item>            ls_sel-p_mat      = ls_alv-comp_material.</item><item>            ls_sel-aufnr      = ls_alv-order_number.</item><item>            ls_sel-p_werks    = ls_alv-prod_plant.</item><item>            ls_sel-lgort_from = ls_alv-storage_location.</item><item>            ls_sel-bwart      = &apos;261&apos;.</item><item>            ls_sel-sobkz      = ls_alv-special_stock.</item><item>            IF ( ls_alv-special_stock = &apos;Q&apos; ).</item><item>              ls_sel-p_posid  = ls_alv-wbs_element.</item><item>            ENDIF.</item><item>            ls_sel-p_menge    = ls_alv-req_quan - ls_alv-withdrawn_quant</item><item>            ls_sel-meins      = ls_alv-entry_uom.</item><item/><item>            registra_mov( EXPORTING is_sel = ls_sel</item><item>                          CHANGING cv_esito       = ls_alv-esito</item><item>                                   cv_descr_esito = ls_alv-descr_esito )</item><item>            IF ( ls_alv-esito = &apos;000&apos; ).</item><item>              ls_alv-ligth = icon_green_light.</item><item>              gv_refresh_data = abap_true.</item><item>            ELSE.</item><item>              ls_alv-ligth = icon_red_light.</item><item>            ENDIF.</item><item>          ELSE.</item><item>            ls_alv-ligth = icon_red_light.</item><item>          ENDIF.</item><item>        ELSE.</item><item>          ls_alv-esito       = &apos;001&apos;.</item><item>          ls_alv-descr_esito = &apos;Impegno chiuso&apos;.</item><item>          ls_alv-ligth = icon_red_light.</item><item>        ENDIF.</item><item>        MODIFY gt_alv_sel1 FROM ls_alv INDEX lv_tabix.</item><item>      ENDIF.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></LOAD_GIAC><PREL_COMP><item>  METHOD prel_comp.</item><item>    DATA: ls_row   TYPE i,</item><item>          ls_data  TYPE ty_s_data_sel1,</item><item>          ls_alv   TYPE ty_s_alv_sel1,</item><item>          lv_tabix TYPE i,</item><item>          lv_err   TYPE abap_bool,</item><item>          lv_kzear TYPE resb-kzear,</item><item>          ls_sel   TYPE ty_s_sel.</item><item/><item>    gv_refresh_data = abap_false.</item><item>    lv_err = abap_false.</item><item>    LOOP AT it_rows INTO ls_row.</item><item>      READ TABLE gt_alv_sel1 INTO ls_alv INDEX ls_row.</item><item>      IF ( sy-subrc = 0 ).</item><item>        lv_tabix = sy-tabix.</item><item>        SELECT SINGLE kzear INTO lv_kzear FROM resb WHERE rsnum = ls_alv</item><item>                                            AND   rspos = ls_alv-reserva</item><item>                                            AND   rsart = ls_alv-reserva</item><item>        CHECK sy-subrc = 0.</item><item>        IF ( lv_kzear IS INITIAL ).</item><item>          IF ( ls_alv-backflush = abap_true ).</item><item>            ls_alv-esito       = &apos;001&apos;.</item><item>            ls_alv-descr_esito = &apos;Prelievo retroattivo&apos;.</item><item>            ls_alv-ligth = icon_red_light.</item><item>            MODIFY gt_alv_sel1 FROM ls_alv INDEX lv_tabix.</item><item>            CONTINUE.</item><item>          ENDIF.</item><item>          break kosmedev.</item><item>          CASE ls_alv-special_stock.</item><item>            WHEN &apos;Q&apos;.</item><item>              IF ( ls_alv-req_quan &gt; ls_alv-prlab ).</item><item>                ls_alv-esito       = &apos;001&apos;.</item><item>                ls_alv-descr_esito = &apos;Stock Q insufficiente&apos;.</item><item>                ls_alv-ligth = icon_red_light.</item><item>                MODIFY gt_alv_sel1 FROM ls_alv INDEX lv_tabix.</item><item>                CONTINUE.</item><item>              ENDIF.</item><item>            WHEN OTHERS.</item><item>              IF ( ls_alv-req_quan &gt; ls_alv-labst ).</item><item>                ls_alv-esito       = &apos;001&apos;.</item><item>                ls_alv-descr_esito = &apos;Giacenza insufficiente&apos;.</item><item>                ls_alv-ligth = icon_red_light.</item><item>                MODIFY gt_alv_sel1 FROM ls_alv INDEX lv_tabix.</item><item>                CONTINUE.</item><item>              ENDIF.</item><item>          ENDCASE.</item><item>          CLEAR: ls_sel.</item><item>          ls_sel-p_mat      = ls_alv-comp_material.</item><item>          ls_sel-aufnr      = ls_alv-order_number.</item><item>          ls_sel-p_werks    = ls_alv-prod_plant.</item><item>          ls_sel-lgort_from = ls_alv-storage_location.</item><item>          ls_sel-lgort_to   = ls_alv-storage_location.</item><item>          ls_sel-bwart      = &apos;261&apos;.</item><item>          ls_sel-sobkz      = ls_alv-special_stock.</item><item>          IF ( ls_alv-special_stock = &apos;Q&apos; ).</item><item>            ls_sel-p_posid  = ls_alv-wbs_element.</item><item>          ENDIF.</item><item>          ls_sel-p_menge    = ls_alv-req_quan - ls_alv-withdrawn_quantit</item><item>          ls_sel-meins      = ls_alv-entry_uom.</item><item/><item>          registra_mov( EXPORTING is_sel = ls_sel</item><item>                        CHANGING cv_esito       = ls_alv-esito</item><item>                                 cv_descr_esito = ls_alv-descr_esito ).</item><item>          IF ( ls_alv-esito = &apos;000&apos; ).</item><item>            ls_alv-ligth = icon_green_light.</item><item>            gv_refresh_data = abap_true.</item><item>          ELSE.</item><item>            ls_alv-ligth = icon_red_light.</item><item>          ENDIF.</item><item>        ELSE.</item><item>          ls_alv-esito       = &apos;001&apos;.</item><item>          ls_alv-descr_esito = &apos;Impegno chiuso&apos;.</item><item>          ls_alv-ligth = icon_red_light.</item><item>        ENDIF.</item><item>        MODIFY gt_alv_sel1 FROM ls_alv INDEX lv_tabix.</item><item>      ENDIF.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></PREL_COMP><MOVE_BAPI_TO_LOCAL><item>  METHOD move_bapi_to_local.</item><item>    DATA: ls_data      TYPE ty_s_data_sel1,</item><item>          lv_field_src TYPE c LENGTH 100,</item><item>          lv_field_dst TYPE c LENGTH 100.</item><item>    FIELD-SYMBOLS: &lt;lv_field_src&gt; TYPE any,</item><item>                   &lt;lv_field_dst&gt; TYPE any.</item><item>    LOOP AT it_header INTO DATA(ls_header).</item><item>      CLEAR: ls_data.</item><item>      MOVE-CORRESPONDING ls_header TO ls_data.</item><item>      LOOP AT it_component INTO DATA(ls_component) WHERE order_number =</item><item>        DATA: lo_struct_descr TYPE REF TO cl_abap_structdescr.</item><item>        TRY.</item><item>            lo_struct_descr ?= cl_abap_structdescr=&gt;describe_by_data( ls</item><item>            LOOP AT lo_struct_descr-&gt;get_components( ) INTO DATA(ls_comp</item><item>              lv_field_src = &apos;ls_component-&apos; &amp;&amp; ls_components-name.</item><item>              lv_field_dst = &apos;ls_data-&apos; &amp;&amp; ls_components-name.</item><item>              IF ( ls_components-name = &apos;RESERVATION_NUMBER&apos; OR</item><item>                   ls_components-name = &apos;MATERIAL&apos; OR</item><item>                   ls_components-name = &apos;BATCH&apos; OR</item><item>                   ls_components-name = &apos;ORDER_NUMBER&apos; OR</item><item>                   ls_components-name = &apos;SYSTEM_STATUS&apos; OR</item><item>                   ls_components-name = &apos;MATERIAL_EXTERNA&apos; OR</item><item>                   ls_components-name = &apos;MATERIAL_GUID&apos; OR</item><item>                   ls_components-name = &apos;MATERIAL_VERSION&apos; OR</item><item>                   ls_components-name = &apos;MATERIAL_LONG&apos; ).</item><item>                lv_field_dst = &apos;ls_data-&apos; &amp;&amp; &apos;comp_&apos; &amp;&amp; ls_components-na</item><item>              ENDIF.</item><item>              ASSIGN (lv_field_src) TO &lt;lv_field_src&gt;.</item><item>              CHECK sy-subrc = 0.</item><item>              ASSIGN (lv_field_dst) TO &lt;lv_field_dst&gt;.</item><item>              CHECK sy-subrc = 0.</item><item>              &lt;lv_field_dst&gt; = &lt;lv_field_src&gt;.</item><item>            ENDLOOP.</item><item>            CLEAR: ls_data-labst, ls_data-PRLAB.</item><item>            IF ( ls_component-special_stock IS INITIAL ).</item><item>              SELECT SINGLE labst INTO ls_data-labst FROM mard WHERE mat</item><item>                                                               AND   wer</item><item>                                                               AND   lgo</item><item>            ELSEIF ( ls_component-special_stock = &apos;Q&apos; ).</item><item>              SELECT SINGLE PRLAB INTO ls_data-PRLAB FROM mspr WHERE mat</item><item>                                                               AND   wer</item><item>                                                               and   lgo</item><item>                                                               AND   sob</item><item>                                                               AND   psp</item><item>            ENDIF.</item><item>            APPEND ls_data TO ct_data.</item><item>          CATCH cx_root.</item><item>        ENDTRY.</item><item>      ENDLOOP.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></MOVE_BAPI_TO_LOCAL><CONS_GIAC><item>  METHOD cons_giac.</item><item>    DATA: ls_row   TYPE i,</item><item>          ls_data  TYPE ty_s_data_sel1,</item><item>          lv_tabix TYPE i,</item><item>          lv_err   TYPE abap_bool,</item><item>          ls_sel   TYPE ty_s_sel.</item><item/><item>    gv_refresh_data = abap_false.</item><item>    lv_err = abap_false.</item><item>    LOOP AT it_rows INTO ls_row.</item><item>      READ TABLE gt_alv_sel2 INTO DATA(ls_alv) INDEX ls_row.</item><item>      IF ( sy-subrc = 0 ).</item><item>        BREAK kosmedev.</item><item>        lv_tabix = sy-tabix.</item><item>        DATA: lv_prlab TYPE mspr-prlab.</item><item>        CLEAR: lv_prlab.</item><item>        SELECT SINGLE prlab INTO lv_prlab FROM mspr WHERE matnr = ls_alv</item><item>                                                    AND   werks = ls_alv</item><item>                                                    AND   lgort = ls_alv</item><item>                                                    AND   sobkz = ls_alv</item><item>                                                    AND   pspnr = ls_alv</item><item>        IF ( ls_alv-prlab &gt;= ls_alv-qta ).</item><item>          CLEAR: ls_sel.</item><item>          ls_sel-p_mat      = ls_alv-matnr.</item><item>          ls_sel-p_werks    = ls_alv-werks.</item><item>          ls_sel-lgort_from = ls_alv-lgort_from.</item><item>          ls_sel-bwart      = &apos;221&apos;.</item><item>          ls_sel-sobkz      = &apos;Q&apos;.</item><item>          zcl_bc_conversion_exit=&gt;conversion_output( EXPORTING iv_field</item><item>                                                     CHANGING cv_field =</item><item>          ls_sel-p_menge  = ls_alv-qta.</item><item>          SELECT SINGLE meins INTO ls_sel-meins FROM mara WHERE matnr =</item><item/><item>          registra_mov( EXPORTING is_sel = ls_sel</item><item>                        CHANGING cv_esito       = ls_alv-esito</item><item>                                 cv_descr_esito = ls_alv-descr_esito ).</item><item>          IF ( ls_alv-esito = &apos;000&apos; ).</item><item>            ls_alv-ligth = icon_green_light.</item><item>            gv_refresh_data = abap_false.</item><item>          ELSE.</item><item>            ls_alv-ligth = icon_red_light.</item><item>          ENDIF.</item><item>        ELSE.</item><item>          ls_alv-ligth = icon_red_light.</item><item>          ls_alv-esito = &apos;001&apos;.</item><item>          ls_alv-descr_esito = &apos;La quantit√† eccede quella dello stock&apos;.</item><item>        ENDIF.</item><item>        MODIFY gt_alv_sel2 FROM ls_alv INDEX lv_tabix.</item><item>      ENDIF.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></CONS_GIAC><EXECUTE_SEL3><item>  METHOD execute_sel3.</item><item>    DATA: ls_sel TYPE ty_s_sel.</item><item>    CLEAR: ls_sel.</item><item>    MOVE-CORRESPONDING gs_sel TO ls_sel.</item><item/><item>    DATA: lv_sobkz        TYPE mssq-sobkz,</item><item>          lv_meins        TYPE mara-meins,</item><item>          lv_fabb_singolo TYPE marc-sbdkz,</item><item>          lv_menge_c      TYPE char17.</item><item/><item>    SELECT SINGLE sbdkz INTO lv_fabb_singolo FROM marc</item><item>           WHERE matnr = gs_sel-p_mat</item><item>           AND   werks = gs_sel-p_werks.</item><item>    IF ( lv_fabb_singolo &lt;&gt; &apos;1&apos; ).</item><item>      CLEAR ls_sel-p_posid.</item><item>    ENDIF.</item><item/><item>    CLEAR: lv_sobkz.</item><item>    IF ( ls_sel-p_posid IS NOT INITIAL ).</item><item>*      zcl_bc_conversion_exit=&gt;conversion_output( EXPORTING iv_field = l</item><item>*                                                 CHANGING cv_field = lv</item><item>      ls_sel-sobkz = &apos;Q&apos;.</item><item>    ENDIF.</item><item>    ls_sel-bwart = &apos;Z22&apos;.</item><item>    ls_sel-lgort_from = ls_sel-p_lgr_to.</item><item/><item>    registra_mov( is_sel = ls_sel ).</item><item>  ENDMETHOD.</item></EXECUTE_SEL3><REGISTRA_MOV><item>  METHOD registra_mov.</item><item>    DATA: lv_sobkz        TYPE mssq-sobkz,</item><item>          lv_meins        TYPE mara-meins,</item><item>          lv_fabb_singolo TYPE marc-sbdkz,</item><item>          lv_posid_in     TYPE ty_s_sel-p_posid,</item><item>          lv_posid_out    TYPE ty_s_sel-p_posid,</item><item>          lv_posid        TYPE prps-posid,</item><item>          lv_menge_c      TYPE char17.</item><item/><item/><item>    CLEAR: lv_meins.</item><item>    lv_meins = is_sel-meins.</item><item>    IF ( is_sel-meins IS INITIAL ).</item><item>      SELECT SINGLE meins INTO lv_meins FROM mara WHERE matnr = is_sel-p</item><item>    ENDIF.</item><item>    WRITE is_sel-p_menge TO lv_menge_c UNIT lv_meins NO-GROUPING.</item><item>    REPLACE &apos;,&apos; WITH &apos;.&apos; INTO lv_menge_c.</item><item>    CONDENSE lv_menge_c.</item><item>    CALL FUNCTION &apos;ZMM_REGISTRA_MOV_MM&apos;</item><item>      EXPORTING</item><item>        i_matnr       = is_sel-p_mat</item><item>        i_aufnr       = is_sel-aufnr</item><item>        i_werks       = is_sel-p_werks</item><item>        i_lgort       = is_sel-lgort_from</item><item>        i_umlgo       = is_sel-lgort_to</item><item>        i_bwart       = is_sel-bwart</item><item>        i_sobkz       = is_sel-sobkz</item><item>        i_posid       = is_sel-p_posid</item><item>        i_menge       = lv_menge_c</item><item>        i_meins       = lv_meins</item><item>*       I_BADGE       =</item><item>*       I_TEST        =</item><item>      IMPORTING</item><item>        e_esito       = cv_esito</item><item>        e_descr_esito = cv_descr_esito.</item><item/><item>    IF ( is_sel-p_sel3 = abap_true ).</item><item>      IF ( cv_esito = &apos;000&apos; ).</item><item>        MESSAGE i368(00) WITH &apos;Movimento registrato&apos;.</item><item>      ELSE.</item><item>        MESSAGE i398(00) WITH &apos;Errore&apos; cv_esito &apos;-&apos; cv_descr_esito.</item><item>      ENDIF.</item><item>    ENDIF.</item><item>  ENDMETHOD.</item></REGISTRA_MOV><SCARICA_GIAC><item>  METHOD scarica_giac.</item><item>    DATA: ls_row   TYPE i,</item><item>          ls_data  TYPE ty_s_data_sel1,</item><item>          lv_tabix TYPE i,</item><item>          lv_err   TYPE abap_bool,</item><item>          ls_sel   TYPE ty_s_sel.</item><item/><item>    gv_refresh_data = abap_false.</item><item>    lv_err = abap_false.</item><item>    LOOP AT it_rows INTO ls_row.</item><item>      READ TABLE gt_alv_sel2 INTO DATA(ls_alv) INDEX ls_row.</item><item>      IF ( sy-subrc = 0 ).</item><item>        lv_tabix = sy-tabix.</item><item>        DATA: lv_prlab TYPE mspr-prlab.</item><item>        CLEAR: lv_prlab.</item><item>        SELECT SINGLE prlab INTO lv_prlab FROM mspr WHERE matnr = ls_alv</item><item>                                                    AND   werks = ls_alv</item><item>                                                    AND   lgort = ls_alv</item><item>                                                    AND   sobkz = ls_alv</item><item>                                                    AND   pspnr = ls_alv</item><item>        IF ( ls_alv-prlab &gt;= ls_alv-qta ).</item><item>          CLEAR: ls_sel.</item><item>          ls_sel-p_mat      = ls_alv-matnr.</item><item>          ls_sel-p_werks    = ls_alv-werks.</item><item>          ls_sel-lgort_from = ls_alv-lgort_from.</item><item>          ls_sel-bwart      = &apos;562&apos;.</item><item>          ls_sel-sobkz      = &apos;Q&apos;.</item><item>          zcl_bc_conversion_exit=&gt;conversion_output( EXPORTING iv_field</item><item>                                                     CHANGING cv_field =</item><item>          ls_sel-p_menge  = ls_alv-qta.</item><item>          SELECT SINGLE meins INTO ls_sel-meins FROM mara WHERE matnr =</item><item/><item>          registra_mov( EXPORTING is_sel = ls_sel</item><item>                        CHANGING cv_esito       = ls_alv-esito</item><item>                                 cv_descr_esito = ls_alv-descr_esito ).</item><item>          IF ( ls_alv-esito = &apos;000&apos; ).</item><item>            ls_alv-ligth = icon_green_light.</item><item>            gv_refresh_data = abap_true.</item><item>          ELSE.</item><item>            ls_alv-ligth = icon_red_light.</item><item>          ENDIF.</item><item>        ELSE.</item><item>          ls_alv-ligth = icon_red_light.</item><item>          ls_alv-esito = &apos;001&apos;.</item><item>          ls_alv-descr_esito = &apos;La quantit√† eccede quella dello stock&apos;.</item><item>        ENDIF.</item><item>        MODIFY gt_alv_sel2 FROM ls_alv INDEX lv_tabix.</item><item>      ENDIF.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></SCARICA_GIAC><TRASF_GIAC><item>  METHOD trasf_giac.</item><item>    DATA: ls_row   TYPE i,</item><item>          ls_data  TYPE ty_s_data_sel1,</item><item>          lv_tabix TYPE i,</item><item>          lv_err   TYPE abap_bool,</item><item>          ls_sel   TYPE ty_s_sel.</item><item/><item>    gv_refresh_data = abap_false.</item><item>    lv_err = abap_false.</item><item>    LOOP AT it_rows INTO ls_row.</item><item>      READ TABLE gt_alv_sel2 INTO DATA(ls_alv) INDEX ls_row.</item><item>      IF ( sy-subrc = 0 ).</item><item>        lv_tabix = sy-tabix.</item><item>        DATA: lv_prlab TYPE mspr-prlab.</item><item>        CLEAR: lv_prlab.</item><item>        SELECT SINGLE prlab INTO lv_prlab FROM mspr WHERE matnr = ls_alv</item><item>                                                    AND   werks = ls_alv</item><item>                                                    AND   lgort = ls_alv</item><item>                                                    AND   sobkz = ls_alv</item><item>                                                    AND   pspnr = ls_alv</item><item>        IF ( ls_alv-prlab &gt;= ls_alv-qta ).</item><item>          CLEAR: ls_sel.</item><item>          ls_sel-p_mat      = ls_alv-matnr.</item><item>          ls_sel-p_werks    = ls_alv-werks.</item><item>          ls_sel-lgort_from = ls_alv-lgort_from.</item><item>          ls_sel-lgort_to   = ls_alv-lgort_to.</item><item>          ls_sel-bwart      = &apos;311&apos;.</item><item>          ls_sel-sobkz      = &apos;Q&apos;.</item><item>          zcl_bc_conversion_exit=&gt;conversion_output( EXPORTING iv_field</item><item>                                                     CHANGING cv_field =</item><item>          ls_sel-p_menge  = ls_alv-qta.</item><item>          SELECT SINGLE meins INTO ls_sel-meins FROM mara WHERE matnr =</item><item/><item>          registra_mov( EXPORTING is_sel = ls_sel</item><item>                        CHANGING cv_esito       = ls_alv-esito</item><item>                                 cv_descr_esito = ls_alv-descr_esito ).</item><item>          IF ( ls_alv-esito = &apos;000&apos; ).</item><item>            ls_alv-ligth = icon_green_light.</item><item>            gv_refresh_data = abap_true.</item><item>          ELSE.</item><item>            ls_alv-ligth = icon_red_light.</item><item>          ENDIF.</item><item>        ELSE.</item><item>          ls_alv-ligth = icon_red_light.</item><item>          ls_alv-esito = &apos;001&apos;.</item><item>          ls_alv-descr_esito = &apos;La quantit√† eccede quella dello stock&apos;.</item><item>        ENDIF.</item><item>        MODIFY gt_alv_sel2 FROM ls_alv INDEX lv_tabix.</item><item>      ENDIF.</item><item>    ENDLOOP.</item><item>  ENDMETHOD.</item></TRASF_GIAC><GET_REFRESH_DATA><item>  method GET_REFRESH_DATA.</item><item>    rv_refresh_data = gv_refresh_data.</item><item>  endmethod.</item></GET_REFRESH_DATA><REFRESH_DATA><item>  METHOD refresh_data.</item><item>    IF ( gv_refresh_data = abap_true ).</item><item>      CASE abap_true.</item><item>        WHEN gs_sel-p_sel1.</item><item>          get_data_sel1( EXPORTING is_sel = gs_sel</item><item>                         CHANGING ct_data = gt_data_sel1 ).</item><item>        WHEN gs_sel-p_sel2.</item><item>          get_data_sel2( EXPORTING is_sel = gs_sel</item><item>                         CHANGING ct_data = gt_data_sel2 ).</item><item>      ENDCASE.</item><item>    ENDIF.</item><item>    gv_refresh_data = abap_false.</item><item>  ENDMETHOD.</item></REFRESH_DATA><SET_REFRESH_DATA><item>  METHOD set_refresh_data.</item><item>    gv_refresh_data = iv_refresh_data.</item><item>  ENDMETHOD.</item></SET_REFRESH_DATA></METHOD_SOURCE></CLASS_ROOT>